import{Z as e,_ as t,R as r}from"./vendor.js";import{_ as n}from"./index7.js";var o="Expected a function",i=NaN,a="[object Symbol]",l=/^\s+|\s+$/g,u=/^[-+]0x[0-9a-f]+$/i,s=/^0b[01]+$/i,c=/^0o[0-7]+$/i,f=parseInt,h="object"==typeof e&&e&&e.Object===Object&&e,p="object"==typeof self&&self&&self.Object===Object&&self,d=h||p||Function("return this")(),v,g=Object.prototype.toString,y=Math.max,b=Math.min,m=function(){return d.Date.now()};function T(e,t,r){var n,i,a,l,u,s,c=0,f=!1,h=!1,p=!0;if("function"!=typeof e)throw new TypeError(o);function d(t){var r=n,o=i;return n=i=void 0,c=t,l=e.apply(o,r)}function v(e){return c=e,u=setTimeout(O,t),f?d(e):l}function g(e){var r,n,o=t-(e-s);return h?b(o,a-(e-c)):o}function T(e){var r=e-s,n;return void 0===s||r>=t||r<0||h&&e-c>=a}function O(){var e=m();if(T(e))return w(e);u=setTimeout(O,g(e))}function w(e){return u=void 0,p&&n?d(e):(n=i=void 0,l)}function S(){void 0!==u&&clearTimeout(u),c=0,n=s=i=u=void 0}function j(){return void 0===u?l:w(m())}function E(){var e=m(),r=T(e);if(n=arguments,i=this,s=e,r){if(void 0===u)return v(s);if(h)return u=setTimeout(O,t),d(s)}return void 0===u&&(u=setTimeout(O,t)),l}return t=_(t)||0,x(r)&&(f=!!r.leading,a=(h="maxWait"in r)?y(_(r.maxWait)||0,t):a,p="trailing"in r?!!r.trailing:p),E.cancel=S,E.flush=j,E}function O(e,t,r){var n=!0,i=!0;if("function"!=typeof e)throw new TypeError(o);return x(r)&&(n="leading"in r?!!r.leading:n,i="trailing"in r?!!r.trailing:i),T(e,t,{leading:n,maxWait:t,trailing:i})}function x(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function w(e){return!!e&&"object"==typeof e}function S(e){return"symbol"==typeof e||w(e)&&g.call(e)==a}function _(e){if("number"==typeof e)return e;if(S(e))return NaN;if(x(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=x(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(l,"");var r=s.test(e);return r||c.test(e)?f(e.slice(2),r?2:8):u.test(e)?NaN:+e}var j=O;function E(){return"undefined"==typeof document||void 0===document.visibilityState||"hidden"!==document.visibilityState}function P(){return void 0===navigator.onLine||navigator.onLine}var R=new Map,F=function e(t,r,n){var o=R.get(t);(null==o?void 0:o.timer)&&clearTimeout(o.timer);var i=void 0;r>-1&&(i=setTimeout((function(){R.delete(t)}),r)),R.set(t,{data:n,timer:i,startTime:(new Date).getTime()})},D=function e(t){var r=R.get(t);return{data:null==r?void 0:r.data,startTime:null==r?void 0:r.startTime}},C=globalThis&&globalThis.__read||function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n=r.call(e),o,i=[],a;try{for(;(void 0===t||t-- >0)&&!(o=n.next()).done;)i.push(o.value)}catch(l){a={error:l}}finally{try{o&&!o.done&&(r=n.return)&&r.call(n)}finally{if(a)throw a.error}}return i},k=globalThis&&globalThis.__spread||function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(C(arguments[t]));return e};function I(e,t){var r=!1;return function(){for(var n=[],o=0;o<arguments.length;o++)n[o]=arguments[o];r||(r=!0,e.apply(void 0,k(n)),setTimeout((function(){r=!1}),t))}}var z=globalThis&&globalThis.__read||function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n=r.call(e),o,i=[],a;try{for(;(void 0===t||t-- >0)&&!(o=n.next()).done;)i.push(o.value)}catch(l){a={error:l}}finally{try{o&&!o.done&&(r=n.return)&&r.call(n)}finally{if(a)throw a.error}}return i},M=globalThis&&globalThis.__spread||function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(z(arguments[t]));return e};function K(e){var r=t.exports.useRef((function(){throw new Error("Cannot call an event handler while rendering.")}));r.current=e;var n=t.exports.useCallback((function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=r.current;if(n)return n.apply(void 0,M(e))}),[r]);if("function"==typeof e)return n}var W=function e(r,n){var o=t.exports.useRef(!1);t.exports.useEffect((function(){return function(){o.current=!1}}),[]),t.exports.useEffect((function(){if(o.current)return r();o.current=!0}),n)},V=[];function L(e){return V.push(e),function t(){var r=V.indexOf(e);V.splice(r,1)}}var N=!1;if("undefined"!=typeof window&&window.addEventListener&&!N){var H=function e(){if(E()&&P())for(var t=0;t<V.length;t++){var r;(0,V[t])()}};window.addEventListener("visibilitychange",H,!1),window.addEventListener("focus",H,!1),N=!0}var q=[];function U(e){return q.push(e),function t(){var r=q.indexOf(e);q.splice(r,1)}}var Y=!1;if("undefined"!=typeof window&&window.addEventListener&&!Y){var $=function e(){if(E())for(var t=0;t<q.length;t++){var r;(0,q[t])()}};window.addEventListener("visibilitychange",$,!1),Y=!0}var A=globalThis&&globalThis.__assign||function(){return A=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},A.apply(this,arguments)},Q=globalThis&&globalThis.__read||function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n=r.call(e),o,i=[],a;try{for(;(void 0===t||t-- >0)&&!(o=n.next()).done;)i.push(o.value)}catch(l){a={error:l}}finally{try{o&&!o.done&&(r=n.return)&&r.call(n)}finally{if(a)throw a.error}}return i},Z=globalThis&&globalThis.__spread||function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(Q(arguments[t]));return e},B="AHOOKS_USE_REQUEST_DEFAULT_KEY",G=function(){function e(e,t,r,o){this.count=0,this.pollingWhenVisibleFlag=!1,this.pollingTimer=void 0,this.loadingDelayTimer=void 0,this.unsubscribe=[],this.that=this,this.state={loading:!1,params:[],data:void 0,error:void 0,run:this.run.bind(this.that),mutate:this.mutate.bind(this.that),refresh:this.refresh.bind(this.that),cancel:this.cancel.bind(this.that),unmount:this.unmount.bind(this.that)},this.service=e,this.config=t,this.subscribe=r,o&&(this.state=A(A({},this.state),o)),this.debounceRun=this.config.debounceInterval?n(this._run,this.config.debounceInterval):void 0,this.throttleRun=this.config.throttleInterval?j(this._run,this.config.throttleInterval):void 0,this.limitRefresh=I(this.refresh.bind(this),this.config.focusTimespan),this.config.pollingInterval&&this.unsubscribe.push(U(this.rePolling.bind(this))),this.config.refreshOnWindowFocus&&this.unsubscribe.push(L(this.limitRefresh.bind(this)))}return e.prototype.setState=function(e){void 0===e&&(e={}),this.state=A(A({},this.state),e),this.subscribe(this.state)},e.prototype._run=function(){for(var e=this,t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];this.pollingTimer&&clearTimeout(this.pollingTimer),this.loadingDelayTimer&&clearTimeout(this.loadingDelayTimer),this.count+=1;var n=this.count;return this.setState({loading:!this.config.loadingDelay,params:t}),this.config.loadingDelay&&(this.loadingDelayTimer=setTimeout((function(){e.setState({loading:!0})}),this.config.loadingDelay)),this.service.apply(this,Z(t)).then((function(r){if(n!==e.count)return new Promise((function(){}));e.loadingDelayTimer&&clearTimeout(e.loadingDelayTimer);var o=e.config.formatResult?e.config.formatResult(r):r;return e.setState({data:o,error:void 0,loading:!1}),e.config.onSuccess&&e.config.onSuccess(o,t),o})).catch((function(r){if(n!==e.count)return new Promise((function(){}));if(e.loadingDelayTimer&&clearTimeout(e.loadingDelayTimer),e.setState({data:void 0,error:r,loading:!1}),e.config.onError&&e.config.onError(r,t),e.config.throwOnError)throw r;return console.error(r),Promise.reject("useRequest has caught the exception, if you need to handle the exception yourself, you can set options.throwOnError to true.")})).finally((function(){if(n===e.count&&e.config.pollingInterval){if(!E()&&!e.config.pollingWhenHidden)return void(e.pollingWhenVisibleFlag=!0);e.pollingTimer=setTimeout((function(){e._run.apply(e,Z(t))}),e.config.pollingInterval)}}))},e.prototype.run=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return this.debounceRun?(this.debounceRun.apply(this,Z(e)),Promise.resolve(null)):this.throttleRun?(this.throttleRun.apply(this,Z(e)),Promise.resolve(null)):this._run.apply(this,Z(e))},e.prototype.cancel=function(){this.debounceRun&&this.debounceRun.cancel(),this.throttleRun&&this.throttleRun.cancel(),this.loadingDelayTimer&&clearTimeout(this.loadingDelayTimer),this.pollingTimer&&clearTimeout(this.pollingTimer),this.pollingWhenVisibleFlag=!1,this.count+=1,this.setState({loading:!1})},e.prototype.refresh=function(){return this.run.apply(this,Z(this.state.params))},e.prototype.rePolling=function(){this.pollingWhenVisibleFlag&&(this.pollingWhenVisibleFlag=!1,this.refresh())},e.prototype.mutate=function(e){"function"==typeof e?this.setState({data:e(this.state.data)||{}}):this.setState({data:e})},e.prototype.unmount=function(){this.cancel(),this.unsubscribe.forEach((function(e){e()}))},e}();function J(e,r){var n=r||{},o=n.refreshDeps,i=void 0===o?[]:o,a=n.manual,l=void 0!==a&&a,u=n.onSuccess,s=void 0===u?function(){}:u,c=n.onError,f=void 0===c?function(){}:c,h=n.defaultLoading,p=void 0!==h&&h,d=n.loadingDelay,v=n.pollingInterval,g=void 0===v?0:v,y=n.pollingWhenHidden,b=void 0===y||y,m=n.defaultParams,T=void 0===m?[]:m,O=n.refreshOnWindowFocus,x=void 0!==O&&O,w=n.focusTimespan,S=void 0===w?5e3:w,_=n.fetchKey,j=n.cacheKey,E=n.cacheTime,P=void 0===E?3e5:E,R=n.staleTime,C=void 0===R?0:R,k=n.debounceInterval,I=n.throttleInterval,z=n.initialData,M=n.ready,V=void 0===M||M,L=n.throwOnError,N=void 0!==L&&L,H=t.exports.useRef(B),q=K(e),U=K(s),Y=K(f),$=K(_),J;"formatResult"in n&&(J=n.formatResult);var X,ee={formatResult:K(J),onSuccess:U,onError:Y,loadingDelay:d,pollingInterval:g,pollingWhenHidden:b,refreshOnWindowFocus:!l&&x,focusTimespan:S,debounceInterval:k,throttleInterval:I,throwOnError:N},te=K((function(e,t){oe((function(r){return r[e]=t,A({},r)}))})),re=Q(t.exports.useState((function(){var e;if(j){var t=null===(e=D(j))||void 0===e?void 0:e.data;if(t){H.current=t.newstFetchKey;var r={};return Object.keys(t.fetches).forEach((function(e){var n=t.fetches[e],o=new G(q,ee,te.bind(null,e),{loading:n.loading,params:n.params,data:n.data,error:n.error});r[e]=o.state})),r}}return{}})),2),ne=re[0],oe=re[1],ie=t.exports.useRef(ne);ie.current=ne;var ae=t.exports.useRef(),le=t.exports.useCallback((function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(V){if($){var r=$.apply(void 0,Z(e));H.current=void 0===r?B:r}var n=H.current,o=ie.current[n];if(!o){var i=new G(q,ee,te.bind(null,n),{data:z});o=i.state,oe((function(e){return e[n]=o,A({},e)}))}return o.run.apply(o,Z(e))}ae.current=e}),[_,te,V]),ue=t.exports.useRef(le);ue.current=le,W((function(){j&&F(j,P,{fetches:ne,newstFetchKey:H.current})}),[j,ne]);var se=t.exports.useRef(!1);W((function(){V&&(!se.current&&ae.current&&ue.current.apply(ue,Z(ae.current)),se.current=!0)}),[V]),t.exports.useEffect((function(){var e;if(!l)if(Object.keys(ne).length>0){var t=j&&(null===(e=D(j))||void 0===e?void 0:e.startTime)||0;-1===C||(new Date).getTime()-t<=C||Object.values(ne).forEach((function(e){e.refresh()}))}else ue.current.apply(ue,Z(T))}),[]);var ce=t.exports.useCallback((function(){Object.values(ie.current).forEach((function(e){e.unmount()})),H.current=B,oe({}),ie.current={}}),[oe]);W((function(){l||Object.values(ie.current).forEach((function(e){e.refresh()}))}),Z(i)),t.exports.useEffect((function(){return function(){Object.values(ie.current).forEach((function(e){e.unmount()}))}}),[]);var fe=t.exports.useCallback((function(e){return function(){console.warn("You should't call "+e+" when service not executed once.")}}),[]);return A(A({loading:V&&!l||p,data:z,error:void 0,params:[],cancel:fe("cancel"),refresh:fe("refresh"),mutate:fe("mutate")},ne[H.current]||{}),{run:le,fetches:ne,reset:ce})}var X=globalThis&&globalThis.__assign||function(){return X=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},X.apply(this,arguments)},ee=globalThis&&globalThis.__rest||function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var o=0,n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(r[n[o]]=e[n[o]]);return r},te=globalThis&&globalThis.__read||function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n=r.call(e),o,i=[],a;try{for(;(void 0===t||t-- >0)&&!(o=n.next()).done;)i.push(o.value)}catch(l){a={error:l}}finally{try{o&&!o.done&&(r=n.return)&&r.call(n)}finally{if(a)throw a.error}}return i},re=globalThis&&globalThis.__spread||function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(te(arguments[t]));return e};function ne(e,r){var n=r.refreshDeps,o=void 0===n?[]:n,i=r.ref,a=r.isNoMore,l=r.threshold,u=void 0===l?100:l;r.fetchKey;var s=ee(r,["refreshDeps","ref","isNoMore","threshold","fetchKey"]),c=te(t.exports.useState(!1),2),f=c[0],h=c[1];t.exports.useEffect((function(){r.fetchKey&&console.warn("useRequest loadMore mode don't need fetchKey!")}),[]);var p=J(e,X(X({},s),{fetchKey:function e(t){var r;return(null===(r=null==t?void 0:t.list)||void 0===r?void 0:r.length)||0},onSuccess:function e(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];h(!1),r.onSuccess&&r.onSuccess.apply(r,re(t))}})),d=p.data,v=p.run,g=p.params,y=p.reset,b=p.loading,m=p.fetches,T=t.exports.useCallback((function(){y();var e,t=te(g).slice(1);v.apply(void 0,re([void 0],t))}),[v,y,g]),O=t.exports.useRef(T);O.current=T,W((function(){r.manual||O.current()}),re(o));var x=t.exports.useMemo((function(){var e=[],t=d;return Object.values(m).forEach((function(r){var n,o;(null===(n=r.data)||void 0===n?void 0:n.list)&&(e=e.concat(null===(o=r.data)||void 0===o?void 0:o.list)),r.loading||(t=r.data)})),X(X({},t),{list:e})}),[m,d]),w=!!a&&(!b&&!f&&a(x)),S=t.exports.useCallback((function(){if(!w){h(!0);var e,t=te(g).slice(1);v.apply(void 0,re([x],t))}}),[w,v,x,g]),_=function e(){!b&&!f&&i&&i.current&&i.current.scrollHeight-i.current.scrollTop<=i.current.clientHeight+u&&S()},j=t.exports.useRef(_);return j.current=_,t.exports.useEffect((function(){if(!i||!i.current)return function(){};var e=function e(){return j.current()};return i.current.addEventListener("scroll",e),function(){i&&i.current&&i.current.removeEventListener("scroll",e)}}),[j]),X(X({},p),{data:x,reload:T,loading:b&&0===x.list.length,loadMore:S,loadingMore:f,noMore:w})}var oe=globalThis&&globalThis.__assign||function(){return oe=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},oe.apply(this,arguments)},ie=globalThis&&globalThis.__rest||function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var o=0,n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(r[n[o]]=e[n[o]]);return r},ae=globalThis&&globalThis.__read||function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n=r.call(e),o,i=[],a;try{for(;(void 0===t||t-- >0)&&!(o=n.next()).done;)i.push(o.value)}catch(l){a={error:l}}finally{try{o&&!o.done&&(r=n.return)&&r.call(n)}finally{if(a)throw a.error}}return i},le=globalThis&&globalThis.__spread||function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(ae(arguments[t]));return e};function ue(e,r){r.paginated;var n=r.defaultPageSize,o=void 0===n?10:n,i=r.refreshDeps,a=void 0===i?[]:i,l=r.fetchKey,u=ie(r,["paginated","defaultPageSize","refreshDeps","fetchKey"]);t.exports.useEffect((function(){l&&console.error("useRequest pagination's fetchKey will not work!")}),[]);var s=J(e,oe({defaultParams:[{current:1,pageSize:o}]},u)),c=s.data,f=s.params,h=s.run,p=s.loading,d=ie(s,["data","params","run","loading"]),v=f&&f[0]?f[0]:{},g=v.current,y=void 0===g?1:g,b=v.pageSize,m=void 0===b?o:b,T=v.sorter,O=void 0===T?{}:T,x=v.filters,w=void 0===x?{}:x,S=t.exports.useCallback((function(e){var t=ae(f),r=t[0],n=t.slice(1);h.apply(void 0,le([oe(oe({},r),e)],n))}),[h,f]),_=(null==c?void 0:c.total)||0,j=t.exports.useMemo((function(){return Math.ceil(_/m)}),[m,_]),E=t.exports.useCallback((function(e,t){var r=e<=0?1:e,n=t<=0?1:t,o=Math.ceil(_/n);r>o&&(r=Math.max(1,o)),S({current:r,pageSize:n})}),[_,S]),P=t.exports.useCallback((function(e){E(e,m)}),[E,m]),R=t.exports.useCallback((function(e){E(y,e)}),[E,y]),F=t.exports.useRef(P);F.current=P,W((function(){r.manual||F.current(1)}),le(a));var D=t.exports.useCallback((function(e,t,r){S({current:e.current,pageSize:e.pageSize||o,filters:t,sorter:r})}),[w,O,S]);return oe({loading:p,data:c,params:f,run:h,pagination:{current:y,pageSize:m,total:_,totalPage:j,onChange:E,changeCurrent:P,changePageSize:R},tableProps:{dataSource:(null==c?void 0:c.list)||[],loading:p,onChange:D,pagination:{current:y,pageSize:m,total:_}},sorter:O,filters:w},d)}var se=r.createContext({});se.displayName="UseRequestConfigContext";var ce=globalThis&&globalThis.__assign||function(){return ce=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},ce.apply(this,arguments)},fe=globalThis&&globalThis.__rest||function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var o=0,n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(r[n[o]]=e[n[o]]);return r},he=globalThis&&globalThis.__read||function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n=r.call(e),o,i=[],a;try{for(;(void 0===t||t-- >0)&&!(o=n.next()).done;)i.push(o.value)}catch(l){a={error:l}}finally{try{o&&!o.done&&(r=n.return)&&r.call(n)}finally{if(a)throw a.error}}return i},pe=globalThis&&globalThis.__spread||function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(he(arguments[t]));return e};function de(e,r){void 0===r&&(r={});var n=t.exports.useContext(se),o=ce(ce({},n),r),i=o.paginated,a=o.loadMore,l=o.requestMethod,u=t.exports.useRef(i),s=t.exports.useRef(a);if(u.current!==i)throw Error("You should not modify the paginated of options");if(s.current!==a)throw Error("You should not modify the loadMore of options");u.current=i,s.current=a;var c=function e(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return fetch.apply(void 0,pe(t)).then((function(e){if(e.ok)return e.json();throw new Error(e.statusText)}))},f=l||c,h;switch(typeof e){case"string":h=function t(){return f(e)};break;case"object":var p=e.url,d=fe(e,["url"]);h=function t(){return l?l(e):c(p,d)};break;default:h=function t(){for(var r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];return new Promise((function(t,n){var o=e.apply(void 0,pe(r)),i=o;if(!o.then)switch(typeof o){case"string":i=f(o);break;case"object":var a=o.url,u=fe(o,["url"]);i=l?l(o):c(a,u)}i.then(t).catch(n)}))}}return a?ne(h,o):i?ue(h,o):J(h,o)}se.Provider;var ve,ge=function e(r,n){var o=t.exports.useRef(!1);t.exports.useEffect((function(){if(o.current)return r();o.current=!0}),n)};function ye(e){var r=t.exports.useRef(e);r.current=e;var n=t.exports.useRef();return n.current||(n.current=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return r.current.apply(this,e)}),n.current}var be=globalThis&&globalThis.__assign||function(){return be=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},be.apply(this,arguments)},me=globalThis&&globalThis.__rest||function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var o=0,n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(r[n[o]]=e[n[o]]);return r},Te=globalThis&&globalThis.__read||function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n=r.call(e),o,i=[],a;try{for(;(void 0===t||t-- >0)&&!(o=n.next()).done;)i.push(o.value)}catch(l){a={error:l}}finally{try{o&&!o.done&&(r=n.return)&&r.call(n)}finally{if(a)throw a.error}}return i},Oe=globalThis&&globalThis.__spread||function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(Te(arguments[t]));return e};function xe(e,r){var n=r.form,o=r.refreshDeps,i=void 0===o?[]:o,a=r.manual,l=r.defaultType,u=void 0===l?"simple":l,s=r.defaultParams,c=me(r,["form","refreshDeps","manual","defaultType","defaultParams"]),f=de(e,be(be({},c),{paginated:!0,manual:!0})),h=f.params,p=f.run,d=h[2]||{},v=Te(t.exports.useState(d.type||u),2),g=v[0],y=v[1],b=Te(t.exports.useState(d.allFormData||s&&s[1]||{}),2),m=b[0],T=b[1],O=t.exports.useCallback((function(){if(!n)return{};if(n.getFieldInstance){var e=n.getFieldsValue(),t={};return Object.keys(e).forEach((function(r){n.getFieldInstance&&!n.getFieldInstance(r)||(t[r]=e[r])})),t}return n.getFieldsValue(null,(function(){return!0}))}),[n]),x=t.exports.useRef(n);x.current=n,t.exports.useEffect((function(){if(x.current)if(x.current.getFieldInstance){var e={};Object.keys(m).forEach((function(t){x.current.getFieldInstance&&!x.current.getFieldInstance(t)||(e[t]=m[t])})),x.current.setFieldsValue(e)}else x.current.setFieldsValue(m)}),[g]),t.exports.useEffect((function(){h.length>0?p.apply(void 0,Oe(h)):a||_(s)}),[]);var w=t.exports.useCallback((function(){var e=O(),t;T(be(be({},m),e)),y("simple"===g?"advance":"simple")}),[g,m,O]),S=t.exports.useCallback((function(){var e=O();if(!n)return Promise.resolve();var t=Object.keys(e);return n.getInternalHooks?n.validateFields(t):new Promise((function(e,r){n.validateFields(t,(function(t,n){t?r(t):e(n)}))}))}),[n]),_=t.exports.useCallback((function(e){setTimeout((function(){S().then((function(){var t=O(),n=be(be({},m),t);T(n),p(e?e[0]:be(be({pageSize:r.defaultPageSize||10},h[0]||{}),{current:1}),t,{allFormData:n,type:g})})).catch((function(e){return e}))}))}),[O,p,h,m,g]),j=t.exports.useCallback((function(){n&&n.resetFields(),_()}),[n,_]),E=ye(j);ge((function(){a||E()}),Oe(i));var P=ye((function(e){e&&e.preventDefault&&e.preventDefault(),_()}));return be(be({},f),{search:{submit:P,type:g,changeType:w,reset:j}})}var we=globalThis&&globalThis.__assign||function(){return we=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},we.apply(this,arguments)},Se=function e(t){return{getFieldInstance:function e(r){return t.getNames().includes(r)},setFieldsValue:t.setValues,getFieldsValue:t.getValues,resetFields:t.resetToDefault,validateFields:function e(r,n){t.validate(n)}}},_e=function e(t){var r={dataSource:t.tableProps.dataSource,loading:t.tableProps.loading,onSort:function e(r,n){t.tableProps.onChange({current:t.pagination.current,pageSize:t.pagination.pageSize},t.filters,{field:r,order:n})},onFilter:function e(r){t.tableProps.onChange({current:t.pagination.current,pageSize:t.pagination.pageSize},r,t.sorter)}},n={onChange:t.pagination.changeCurrent,onPageSizeChange:t.pagination.changePageSize,current:t.pagination.current,pageSize:t.pagination.pageSize,total:t.pagination.total};return we(we({},t),{tableProps:r,paginationProps:n})},je=globalThis&&globalThis.__assign||function(){return je=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},je.apply(this,arguments)};function Ee(e,t){var r=xe(e,je(je({},t),{form:t.field?Se(t.field):void 0}));return _e(r)}var Pe=globalThis&&globalThis.__read||function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n=r.call(e),o,i=[],a;try{for(;(void 0===t||t-- >0)&&!(o=n.next()).done;)i.push(o.value)}catch(l){a={error:l}}finally{try{o&&!o.done&&(r=n.return)&&r.call(n)}finally{if(a)throw a.error}}return i};globalThis&&globalThis.__spread;export{ye as a,Ee as u};
